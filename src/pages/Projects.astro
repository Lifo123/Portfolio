---
import Layout from "@Layouts/Layout.astro";
---

<Layout title="Projects" description="Template">
    <main class="section f-col px-4" style="min-height: 88vh;">
        <h1 class="fs-4 fw-700 mb-3">Projects</h1>
        <p class="mb-4">
            Lorem ipsum dolor sit amet consectetur adipisicing elit. Sequi
            adipisci nostrum, dicta excepturi cum quibusdam ullam quod,
            necessitatibus maiores deserunt facilis praesentium unde! Cumque
            libero totam aliquid sint, quas maxime.
        </p>
        <div class="f-row g-2 f-wrap f-center" id="projects-data">
            <!-- El contenido dinámico se inyectará aquí -->
        </div>
    </main>
</Layout>

<script>
    async function fetchCharacter() {
        const res = await fetch(
            "https://app-xr5kdq6jkq-uc.a.run.app/projects/",
        );
        const data = await res.json();
        const characterData = document.getElementById("projects-data");

        Object.keys(data).forEach((key) => {
            const project = data[key];

            // Crea un contenedor para cada proyecto
            const projectDiv = document.createElement("div");
            projectDiv.classList.add("project-card");

            projectDiv.innerHTML = `
                    <div class="px-4 py-3">
                        <h3 class="fs-4">${project.tittle}</h3>
                        <div class="f-row g-2 py-1 mb-2">
                            ${project.techs.map((item) => `<span class="fs-6 fw-400 br-max tag" data-tag="${item}">${item}</span>`).join("")}
                        </div>
                        <p class="fs-2 mb-1">${project.description
                            .split(/\s+/)
                            .map((word) => word.replace(/,/g, "")) 
                            .slice(0, 12)
                            .join(" ")}...
                        </p>
                        <div class="f-row g-2 f-justify-between mt-3">
                            <a class="btn btn-secondary fw-500 br-6 d-flex f-center" href="${project.repository}">Source Code</a>
                            <a class="btn btn-secondary fw-600 br-6 d-flex f-center" href="${project.websiteURL}">Live Demo</a>
                        </div>
                    </div>
                `;

            // Agrega el contenedor del proyecto al DOM
            characterData.appendChild(projectDiv);
        });
    }
    fetchCharacter();
</script>
